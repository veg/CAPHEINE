/*
========================================================================================
    Nextflow config file for running tests
========================================================================================
*/

modules_testdata_base_path = projectDir + '/tests/test_data/'
pipelines_testdata_base_path = projectDir + '/tests/test_data/'

// Impose sensible resource limits for testing
process {
    withName: '.*' {
        cpus   = 4
        memory = 3.GB
        time   = 2.h
    }
    withName: 'HYPHYMPI_*' { cpus = 2 }
}

profiles {
    conda {
        conda.enabled           = true
        docker.enabled          = false
        singularity.enabled     = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        conda.channels          = ['conda-forge', 'bioconda']
        apptainer.enabled       = false
    }
    docker {
        docker.enabled          = true
        conda.enabled           = false
        singularity.enabled     = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        apptainer.enabled       = false
        docker.runOptions       = '-u $(id -u):$(id -g)'
    }
    arm {
        docker.runOptions       = '-u $(id -u):$(id -g) --platform=linux/amd64'
    }
}
